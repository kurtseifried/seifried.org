<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<title>Python Performance Part 3 | Kurt Seifried</title>
<link rel="pingback" href="http://kurt.seifried.org/xmlrpc.php"/>
<script src='https://r-login.wordpress.com/remote-login.php?action=js&amp;host=kurt.seifried.org&amp;id=86342&amp;t=1480695556&amp;back=http%3A%2F%2Fkurt.seifried.org%2F2010%2F05%2F31%2Fpython-performance-part-3%2F' type="text/javascript"></script>
<script type="text/javascript">
		/* <![CDATA[ */
			if ( 'function' === typeof WPRemoteLogin ) {
				document.cookie = "wordpress_test_cookie=test; path=/";
				if ( document.cookie.match( /(;|^)\s*wordpress_test_cookie\=/ ) ) {
					WPRemoteLogin();
				}
			}
		/* ]]> */
		</script>
<link rel='dns-prefetch' href='//s2.wp.com'/>
<link rel='dns-prefetch' href='//s1.wp.com'/>
<link rel='dns-prefetch' href='//s0.wp.com'/>
<link rel='dns-prefetch' href='//kurtseifried.wordpress.com'/>
<link rel="alternate" type="application/rss+xml" title="Kurt Seifried &raquo; Feed" href="http://kurt.seifried.org/feed/"/>
<link rel="alternate" type="application/rss+xml" title="Kurt Seifried &raquo; Comments Feed" href="http://kurt.seifried.org/comments/feed/"/>
<link rel="alternate" type="application/rss+xml" title="Kurt Seifried &raquo; Python Performance Part&nbsp;3 Comments Feed" href="http://kurt.seifried.org/2010/05/31/python-performance-part-3/feed/"/>
<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1473172720h&ver=4.6.1-RC1-38499"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">img.wp-smiley,img.emoji{display:inline!important;border:none!important;box-shadow:none!important;height:1em!important;width:1em!important;margin:0 .07em!important;vertical-align:-0.1em!important;background:none!important;padding:0!important;}</style>
<link rel='stylesheet' id='all-css-0-1' href='https://s2.wp.com/_static/??-eJx9jtEKwjAMRX/IGibTPYnf0nbBdW220KQM/95W8UVlLyH3cg4JbGz8uiguClQMp3IPi0AKEQVmVLY+mlc6epED/MczJqs4Gl5Fv9Ke5teMtSe22gjCMVhMSBXb04gvH6utU31x98zGlTbOcUYRUyeFQkaneujXe9fAxUEsLgcfQfSRsIE3unZ93w3deRhO8xOHmHVX' type='text/css' media='all'/>
<!--[if lte IE 8]>
<link rel='stylesheet' id='kubrick-ie-css'  href='https://s0.wp.com/wp-content/themes/pub/kubrick/ie.css?m=1273203575h&#038;ver=4.6.1-RC1-38499' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='all-css-2-1' href='https://s2.wp.com/_static/??-eJx9i8sKgCAQAH8oWwSjOkTfYmLLhrrig34/u0Rdus3ADBAELmQ45Ad6k3MHZxRNig0FfBXRVaTWoGXh2OhCHD4idqcp/a3Jbo6xIUKrXnpPq1+kGmalplGq4wKxyTcd' type='text/css' media='all'/>
<link rel='stylesheet' id='print-css-3-1' href='https://s0.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035h' type='text/css' media='print'/>
<link rel='stylesheet' id='all-css-4-1' href='https://s1.wp.com/_static/??/wp-content/mu-plugins/actionbar/actionbar.css,/wp-content/themes/h4/global.css?m=1479929846j' type='text/css' media='all'/>
<script type='text/javascript' src='https://s0.wp.com/_static/??-eJyFj+sKwjAMhV/IrHib+kN8ltrFkdqbTevQpzcD/aEOhUDIyZfDiRoSUDCudsjKSl0q5tuzNZZn6hcAnvqsCzaewgs2MRQMZWR9PJJDqIxZ96KJ0SlOcCly8cgs0MT2PRKFK+HwF7NYkjZnyMh0/3L1FZKrPQVWGZ080MGY4WOSq4Pfz1dtu14sd5utfQAruHB+'></script>
<link rel='stylesheet' id='all-css-0-2' href='https://s1.wp.com/wp-content/mu-plugins/highlander-comments/style.css?m=1377793621h' type='text/css' media='all'/>
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s1.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563h&#038;ver=20110606' type='text/css' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://kurtseifried.wordpress.com/xmlrpc.php?rsd"/>
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml"/>
<link rel='prev' title='Python Performance Part&nbsp;2' href='http://kurt.seifried.org/2010/05/31/python-performance-part-2/'/>
<link rel='next' title='Python Performance Part&nbsp;4' href='http://kurt.seifried.org/2010/05/31/python-performance-part-4/'/>
<meta name="generator" content="WordPress.com"/>
<link rel="canonical" href="http://kurt.seifried.org/2010/05/31/python-performance-part-3/"/>
<link rel='shortlink' href='http://wp.me/pmsC-Z'/>
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=json&amp;url=http%3A%2F%2Fkurt.seifried.org%2F2010%2F05%2F31%2Fpython-performance-part-3%2F&amp;for=wpcom-auto-discovery"/><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=xml&amp;url=http%3A%2F%2Fkurt.seifried.org%2F2010%2F05%2F31%2Fpython-performance-part-3%2F&amp;for=wpcom-auto-discovery"/>
 
<meta property="og:type" content="article"/>
<meta property="og:title" content="Python Performance Part 3"/>
<meta property="og:url" content="http://kurt.seifried.org/2010/05/31/python-performance-part-3/"/>
<meta property="og:description" content="Python Performance Part 1 Python Performance Part 2 Python Performance Part 4 In part one I covered a basic introduction to threads and the producer-consumer pattern. In part two I covered the Globâ€¦"/>
<meta property="article:published_time" content="2010-05-31T08:34:32+00:00"/>
<meta property="article:modified_time" content="2011-06-22T23:36:13+00:00"/>
<meta property="og:site_name" content="Kurt Seifried"/>
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg"/>
<meta property="og:locale" content="en_US"/>
<meta name="twitter:site" content="@wordpressdotcom"/>
<meta name="twitter:card" content="summary"/>
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom"/>
<link rel="shortcut icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48"/>
<link rel="icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48"/>
<link rel="apple-touch-icon-precomposed" href="https://s0.wp.com/i/webclip.png"/>
<link rel='openid.server' href='http://kurtseifried.wordpress.com/?openidserver=1'/>
<link rel='openid.delegate' href='http://kurtseifried.wordpress.com/'/>
<link rel="search" type="application/opensearchdescription+xml" href="http://kurt.seifried.org/osd.xml" title="Kurt Seifried"/>
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com"/>
<style type='text/css'><!--
body { background: url("https://s0.wp.com/wp-content/themes/pub/kubrick/images/kubrickbgcolor.gif"); }
#page { background: url("https://s0.wp.com/wp-content/themes/pub/kubrick/images/kubrickbgwide.gif") repeat-y top !important; border: none; }
#header { background: url("https://s0.wp.com/wp-content/themes/pub/kubrick/images/kubrickheader.gif") no-repeat bottom center; }
#footer { background: url("https://s0.wp.com/wp-content/themes/pub/kubrick/images/kubrickfooter.gif") no-repeat bottom; border: none;}
#header { margin: 0 !important; margin: 0 0 0 1px; padding: 1px; height: 198px; width: 758px; }
#headerimg { margin: 7px 9px 0; height: 192px; width: 740px; }
#headerimg h1 a, #headerimg h1 a:visited, #headerimg .description { color: ; }
#headerimg h1 a, #headerimg .description { display:  }

	--></style><meta name="application-name" content="Kurt Seifried"/><meta name="msapplication-window" content="width=device-width;height=device-height"/><meta name="msapplication-tooltip" content="Just another blog from just another guy (kurt@seifried.org)"/><meta name="msapplication-task" content="name=Subscribe;action-uri=http://kurt.seifried.org/feed/;icon-uri=https://s2.wp.com/i/favicon.ico"/><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=http://s2.wp.com/i/favicon.ico"/><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico"/><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico"/><meta name="title" content="Python Performance Part&nbsp;3 | Kurt Seifried on WordPress.com"/>
<meta name="description" content="Python Performance Part 1 Python Performance Part 2 Python Performance Part 4 In part one I covered a basic introduction to threads and the producer-consumer pattern. In part two I covered the Global Interpreter Lock (GIL) and some of the more pathological behavior it can cause. Now we&#039;re going to go over how to profile&hellip;"/>
<link rel="amphtml" href="http://kurt.seifried.org/2010/05/31/python-performance-part-3/amp/"/><style type="text/css" id="syntaxhighlighteranchor"></style>
</head>
<body class="single single-post postid-61 single-format-standard mp6 customizer-styles-applied highlander-enabled highlander-light">
<div id="page">
<div id="header">
<div id="headerimg" onclick=" location.href='http://kurt.seifried.org';" style="cursor: pointer;">
<h1><a href="http://kurt.seifried.org/">Kurt Seifried</a></h1>
<div class="description">Just another blog from just another guy (<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="3e554b4c4a7e4d5b57584c575b5a10514c59">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>)</div>
</div>
</div>
<hr/>
<div id="content" class="widecolumn">
<div class="navigation">
<div class="alignleft">&laquo; <a href="http://kurt.seifried.org/2010/05/31/python-performance-part-2/" rel="prev">Python Performance Part&nbsp;2</a></div>
<div class="alignright"><a href="http://kurt.seifried.org/2010/05/31/python-performance-part-4/" rel="next">Python Performance Part&nbsp;4</a> &raquo;</div>
</div>
<div class="clear post-61 post type-post status-publish format-standard hentry category-python tag-performance tag-python-2" id="post-61">
<h2>Python Performance Part&nbsp;3</h2>
<small class="single-by"></small>
<div class="entry">
<p><a href="http://kurt.seifried.org/2010/05/31/python-performance-part-1/">Python Performance Part 1</a><br/>
<a href="http://kurt.seifried.org/2010/05/31/python-performance-part-2/">Python Performance Part 2</a><br/>
<a href="http://kurt.seifried.org/2010/05/31/python-performance-part-4/">Python Performance Part 4</a></p>
<p>In part one I covered a basic introduction to threads and the producer-consumer pattern. In part two I covered the Global Interpreter Lock (GIL) and some of the more pathological behavior it can cause. Now we&#8217;re going to go over how to profile code and how to instrument code so you can measure the performance of it so you can know with some certainty if the code actually needs to be fixed (and how it can be fixed). Finally we&#8217;ll go over some significant ways in which we can improve our handling of the producer-consumer pattern that will be more efficient and reliable.</p>
<p><strong>Profiling vs. Performance measurement</strong></p>
<p>Profiling and performance measurement are closely related but there is a difference. Profiling will generally give you every a lot of detail: function returns and exception events and since Python supports deterministic profiling it will do so with an extremely high degree of accuracy. The output of Python profiling is staggering, every single detail, the number of calls (ncalls), total time (tottime), per call time (tottime divided by ncalls), cumulative time (including sub calls/etc. for a function, cumtime) and the filename and line number and function called (filename:lineno(function)). In other words everything (this is one advantage of using an interpreted language). For most of us profiling should be used once the code has been written (premature optimization and all that) and used a bit (testing or otherwise). Performance measurement tends to be coarse grained, for example adding hooks that record how long a database operation takes to return or how long it takes to generate a web page in total. As well you can insert performance measuring code into your application and use it to continuously monitor system state/health (i.e. average DB query time over the last 5 minutes, etc.) and alert you if a problem occurs which is something that profiling is not really suited for.</p>
<p><strong>Profiling Python code</strong></p>
<p>Python provides two main profilers: &#8220;profile&#8221; and &#8220;cProfile&#8221; [PROFILE](a third one, &#8220;hotshot&#8221; has been deprecated and may be removed in the next version of Python according to the documentation). &#8220;profile&#8221; and &#8220;cProfile&#8221; are essentially identical with respect to usage, however the &#8220;cPython&#8221; module (written in C) is much faster and won&#8217;t slow your code down significantly. The &#8220;profile&#8221; module will slow your code down significantly, but as it is written in Python it can easily be modified or extended should you need to. Because Python is an interpreted language the interpreter is active during code execution, you don&#8217;t need to add instrumented code as it is already present.</p>
<table width="680" border="1" cellspacing="0" cellpadding="7">
<col width="664"/>
<tbody>
<tr>
<td valign="TOP" width="664">A simple example of profiling</td>
</tr>
<tr>
<td valign="TOP" width="664">
<pre>&gt;&gt;&gt; def count():
...Â Â Â Â  n = 100000
...Â Â Â Â  while n &gt; 0:
...Â Â Â Â Â Â Â Â Â Â Â Â  n -= 1
...
&gt;&gt;&gt; import cProfile
&gt;&gt;&gt; cProfile.run('count()', 'countprof')
&gt;&gt;&gt; import pstats
&gt;&gt;&gt; p = pstats.Stats('countprof')
&gt;&gt;&gt; print p
&lt;pstats.Stats instance at 0x254fb48&gt;
&gt;&gt;&gt; p.print_stats()
Mon JanÂ  4 00:19:11 2010Â Â Â  countprof

 3 function calls in 0.012 CPU seconds

 Random listing order was used

 ncallsÂ  tottimeÂ  percallÂ  cumtimeÂ  percall filename:lineno(function)
 1Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 {method 'disable' of '_lsprof.Profiler' objects}
 1Â Â Â  0.000Â Â Â  0.000Â Â Â  0.012Â Â Â  0.012 &lt;string&gt;:1(&lt;module&gt;)
 1Â Â Â  0.012Â Â Â  0.012Â Â Â  0.012Â Â Â  0.012 &lt;stdin&gt;:1(count)</pre>
</td>
</tr>
</tbody>
</table>
<p>An excellent video covering this is available from Mike Fletcher [Mike C. Fletcher]</p>
<p><span style="text-decoration:underline;"><a href="http://us.pycon.org/2009/conference/schedule/event/15/">http://us.pycon.org/2009/conference/schedule/event/15/</a></span></p>
<p>What we can take away from this and other sources appears to be:</p>
<ol>
<li>You need to be able to properly measure performance before you profile code (luckily Python makes this trivial)</li>
<li>Save your profiling results so you can compare things before and after (in other words did your optimization actually help)</li>
<li>Check your algorithms; a stupid algorithm will always be slow</li>
<li>Find function calls that are used often or are slow (and thus where you should start looking at first)</li>
<li>Look for operations or results that can be pooled (i.e. using a single database query with a JOIN statement instead of multiple queries to get a collection of data)</li>
<li>Look for operations that can be cached (keep your results around if you will use them again)</li>
<li>Anytime you rely upon external code (especially opaque or closed source code) you are very much at the mercy of someone else</li>
<li>Anytime you rely upon an external service (a database, reading or writing a file from the local system, getting a web page, etc.) you are very much at the mercy of someone else (in other words watch out for IO which may show up as lots of time spent sleeping)</li>
<li>Only optimize one thing at a time unless you are incredibly brave</li>
<li>Profiling threaded code can be problematic on multi-threaded or multiprocessor code</li>
</ol>
<p>Of course I could be wrong. One last note, you can convert all this information into nice dot graphs using Gprof2Dot [GPROF2DOT].</p>
<p><strong>Using cProfile</strong></p>
<p>Using cProfile is easy; you import it as a module and then run code using it as a wrapper:</p>
<table width="680" border="1" cellspacing="0" cellpadding="7">
<col width="325"/>
<col width="325"/>
<tbody>
<tr valign="TOP">
<td width="325">
<pre><span style="font-family:Courier New,monospace;"><span style="font-size:x-small;">import cProfile </span></span><span style="font-family:Courier New,monospace;"><span style="font-size:x-small;"><span style="font-family:Courier New,monospace;"><span style="font-size:x-small;">cProfile.run('foo()', 'foo_profile')</span></span></span></span></pre>
<p>&nbsp;</td>
<td width="325"></td>
</tr>
</tbody>
</table>
<p>This will execute the function foo() and output the data from the profile run to the file foo_profile. This is great if you just want to profile a specific class or function within your program. Alternatively if you want to profile the entire program you can use cProfile to execute the Python program in question and profile the entire thing:</p>
<table width="680" border="1" cellspacing="0" cellpadding="7">
<col width="664"/>
<tbody>
<tr>
<td valign="TOP" width="664">
<pre># /usr/lib64/python2.6/cProfile.py -o base64-profile /usr/lib64/python2.6/base64.py /etc/resolv.conf
# python

&gt;&gt;&gt; import pstats
&gt;&gt;&gt; p = pstats.Stats('base64-profile')
&gt;&gt;&gt; p.print_stats()
Tue JanÂ  5 02:37:04 2010Â Â Â  test-output.1

 282 function calls in 0.008 CPU seconds

 Random listing order was used

 ncallsÂ  tottimeÂ  percallÂ  cumtimeÂ  percall filename:lineno(function)
 2Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 {method 'items' of 'dict' objects}
 1Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 /usr/lib64/python2.6/getopt.py:16(&lt;module&gt;)
 1Â Â Â  0.000Â Â Â  0.000Â Â Â  0.002Â Â Â  0.002 /usr/lib64/python2.6/base64.py:3(&lt;module&gt;)
 4Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 {method 'read' of 'file' objects}
 1Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 {open}
 3Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 {len}
 1Â Â Â  0.006Â Â Â  0.006Â Â Â  0.008Â Â Â  0.008 {execfile}
 256Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 {chr}
 1Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 /usr/lib64/python2.6/getopt.py:39(GetoptError)
 2Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 {binascii.b2a_base64}
 1Â Â Â  0.000Â Â Â  0.000Â Â Â  0.008Â Â Â  0.008 &lt;string&gt;:1(&lt;module&gt;)
 1Â Â Â  0.001Â Â Â  0.001Â Â Â  0.001Â Â Â  0.001 /usr/lib64/python2.6/base64.py:326(test)
 2Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 {method 'write' of 'file' objects}
 1Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 {method 'sort' of 'list' objects}
 1Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 {method 'disable' of '_lsprof.Profiler' objects}
 1Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 /usr/lib64/python2.6/base64.py:285(encode)
 1Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 {method 'startswith' of 'str' objects}
 1Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 {range}
 1Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000Â Â Â  0.000 /usr/lib64/python2.6/getopt.py:52(getopt)

&lt;pstats.Stats instance at 0x7fad1e6c1ab8&gt;</pre>
</td>
</tr>
</tbody>
</table>
<p>As you can see I ran the file /etc/resolv.conf through the Python base64 encode/decode utility. The first obvious thing to jump out is heavy use of the &#8220;chr()&#8221; function. This function returns a string one character at a time but appears to be extremely efficient (virtually no CPU time was used). The only thing that really appears to have taken any time is the execfile() function which parses a file. As you can imagine a Python application of any real size will generate a lot of output. Use of cPython is covered in detail in <a href="http://docs.python.org/library/profile.html" rel="nofollow">http://docs.python.org/library/profile.html</a></p>
<p><strong>Measuring Python code performance </strong></p>
<p>There&#8217;s a couple of ways to measure Python code execution, the most accurate for small amounts is the timeit.Timer() function. You basically wrap your function in this and it reports how long things took to run, it can also takes a repeat command, so for operations that are relatively fast you can run them a few thousand (or million times) to get an idea of how long they take. This module is generally best used when testing algorithms or other short pieces of code since it won&#8217;t give details of where things are being slow (just an overall picture).</p>
<p>But what about instrumenting code for long term monitoring, or measuring the speed of external software and services such as database queries? Some strategies here include simply using the time.time() method to get the current time at the start and end of the code you are interested in, subtract the two and you get the elapsed time. This allows you to wrap a call to a database; if the query takes more than say 5 seconds you can send a warning of some sort (log an alert, send an email, etc.). If you are processing database entries you can log the primary key and the start time when you start processing the entity, once done processing (possibly after shoving it through several work queues/etc.) you log the finish time, and ideally log these results.</p>
<p><strong>A note on long term performance monitoring</strong></p>
<p>A major advantage of architecting in performance monitoring is that you can generate long term stats regarding your code, application and environment. Things like how long database queries take, swap the disks for solid stats disks and see if or what a difference it makes, network latency/speed issues, etc. My advice would be to measure the performance of external libraries and services since profiling won&#8217;t really address this. I would also measure the overall performance of things (how long from page request to page generation, or page generation and writing of back end data, etc.). Especially if you are splitting work up using work queues profiling won&#8217;t help since you can&#8217;t track the processing of a specific message/request/etc. within that context easily.</p>
<p>Additionally if you do this by using function decorators you can simply create a timing function and wrap your database query class or whatever function it is you want to monitor without having to modify your code significantly.</p>
<p><strong>Disassembling Python code</strong></p>
<p>I thought I should add a quick note on disassembling Python code (so you can find out approximately how many ticks it is). In some cases where you suspect a computation or a task is causing a lot of context switching you may wish to look at modifying the sys.setcheckinterval() and increasing it. But of course simply twiddling the knobs until you get a better result is probably not the easiest way to accomplish this. Using the dis[DIS] module you can disassemble code, see &#8220;The trouble with ticks&#8221; in the second part of this series for an example. You may be lucky and find that setting the sys.setcheckinterval() helps (e.g. if you computation takes 120 ticks and it can now complete in one run rather than being interrupted) but I would urge extreme caution as it may have unintended side effects that are difficult to track down.</p>
<p><strong>Shared resources, locking and performance</strong></p>
<p>So what happens if you profile or time your code in testing and find that it is reasonably fast; but when you run it in a multi-threaded or multi-process environment you find your code crawls to a stand still or takes far more time than it should? Chances are you have some form of shared resource or locking, that when run in small trials doesn&#8217;t create contention, but when run in production does. The best manner to deal with this is of course to avoid having any resources that require locking or can&#8217;t easily be shared. Additionally I have found that the less shared resources, locking and other synchronization issues I have to deal with, the fewer bugs and I create (imagine that). The two best ways to deal with this are to profile and monitor your code, code that spends a lot of time sleeping may be waiting on a shared lock, and if something takes to long to run (such as a database query) you may have an external resource that doesn&#8217;t share well (i.e. a MySQL MyISAM table that forces table level locking for inserts can really kill performance when you have multiple INSERT or UPDATE statements happening at the same time).</p>
<p><strong>Mapping critical code sections</strong></p>
<p>If you must have shared resources you want to minimize their impact as much as possible, identify the minimal amount of code that needs to hold a lock on a shared resource and only wrap that code with the lock. One note: if your critical code relies on external code or services all bets are off (you hold a lock, then do a DB query and the DB query is very slow or fails or whatever you are out of luck and your application will grind to a halt). Look for code that establishes a lock using locking primitives such as acquire() and release() or threading.lock() and multiprocessing.Lock(). Additionally any databases you connect to may use table level locking, thus if one thread or process is running an INSERT or an UPDATE no other thread or process will be able to. You also want to ensure there are no concurrent deadlocks (i.e. thread #1 holds lock A while waiting to acquire lock B and thread #2 is holding lock B and waiting to acquire lock A, neither one gives up their lock and neither one can move forwards). If you must have multiple locks I would strongly suggest using locking hierarchies (e.g. always lock A and then lock B so no deadlock can occur); there are several excellent articles available on this topic. [LOCKING HIERARCHY]</p>
<p><strong>A note on external C libraries</strong></p>
<p>According to some sources Python is generally capable of running at around 10-20% of the speed of a compiled C program for the same algorithm (due to interpreter overhead, etc.). Generally speaking this won&#8217;t be a significant problem since many applications are IO bound (networks, disks, etc.) and modern CPU&#8217;s are quite fast. But what happens when you start pegging the CPU because of computation being done in Python? Again there is good news here, Guido van Rossum comes from a scientific computing (a.k.a. number crunching) background and this is one of the first things Python was designed to handle. You can (with relative ease) write C or C++ code and use it to extend Python code[PYTHON AND C]. This has already been done with a number of core modules, as mentioned above the cProfile and profile extensions accomplish the same work but as cPython is written in C it runs much faster. If you need to do heavy computation you will want to check out SciPy which is written largely in C and NumPy which is quite fast. [SCIPY]</p>
<p><strong>An Extension to the Advanced Threading pattern &#8211; spinlocks</strong></p>
<p>Normally we would use the thread.join() method but in this case we need a little more flexibility. The use of a spinlock (the thread simply spins, checking the lock repeatedly and once the lock releases it then continues doing whatever it is supposed to).</p>
<p>One of the main problems with the producer-consumer pattern is starvation. What if the producer can&#8217;t go fast enough to feed the workers and the workers have to wait for work? This in and of itself is not an insurmountable problem, however when combined with the fact that we want the Python script to run and exit in a timely manner (i.e. when all the work is done) and not before it is done how do we avoid a starvation situation triggering an early end of the program? The simplest method is to use a lock hierarchy, we have the producer establish a spinlock that it unlocks once it is done feeding data into the queue. The consumers also set a spinlock, if they notice that the queue is empty they can then check the producer spinlock, if this is not set then they know it is a simple starvation problem and that they should keep rechecking the queue until there is more work. However if they check the producer spinlock and it is set as done then they know that there is no more work to be done and they can also exit. One of the simpler ways this can be done is to create an array for each pool of threads (i.e. one for producers and one for consumers). Use the thread ID as the key and a value of 0 or 1 to indicate if the thread is done or not, then you can simply use something like &#8220;while (0 in spinlockProducerThread)&#8221; to see if any threads are still running. Ultimately this pattern can also be applied to the main thread, we simply have the main thread spawn off the producer and consumer threads and then spin until all the locks are released, indicating that all the work is done and the threads are finished. Additionally this allows us to have threads exit when they are done (i.e. once the producer thread has pushed all the work into the queue there is no reason to leave it running, because the spinlock is external we can exit, unlike if we were to use the thread.join() method). This pattern also works really well if you have multiple levels of producers and consumers, i.e. a chain of modules that downloads a web page, processes the content within it, then creates something based on the content and so on. This pattern also lends itself to distributed systems, by taking the locking mechanism and making it external to the running code (for example by using a database table as a shared blackboard to communicate) allows multiple systems to join, do work and then leave (allowing you to dynamically allocate resources).</p>
<table width="680" border="1" cellspacing="0" cellpadding="7">
<col width="664"/>
<tbody>
<tr>
<td valign="TOP" width="664">web_get_producer_consumer_basic_pattern.py (outline of code)</td>
</tr>
<tr>
<td valign="TOP" width="664">
<pre>class ProducerThread:
	def __init__(self, myID):
		self.myID = myID
		while 1:
			work_todo = GetWorkFromDB()
			for work_item in work_todo:
				workQueue.put(work_item)
			break
		spinlockProducerThread[myID] = 1
		sys.exit()

class ConsumerThread:
	def __init__(self, myID):
		self.myID = myID
		while 1:
			try:
				work_item = workQueue.get(block=False)
			except Queue.Empty:
				"""
				The queue is empty, but it may only be temporarily empty or it may
				be empty but other worker threads are still running
				"""
				if (0 not in spinlockProducerThread):
					spinlockConsumerThread[myID] = 1
					sys.exit()
			else:
				ProcessWork(work_item)

if __name__ == '__main__':

	spinlockProducerThread = [0] * number_of_producer_threads

	spinlockConsumerThread = [0] * number_of_consumer_threads

	workQueue = Queue.Queue()  

	for i in range(number_of_producer_threads):
		try:
			thread.start_new_thread(ProducerThread, (i,))
		except thread.error, e:
			myID = i
			spinlockProducerThread[myID] = 1
			print "ProducerThread thread creation failed"
			print e

	for i in range(number_of_consumer_threads):
		try:
			thread.start_new_thread(ThreadWorkerFreescan, (i,))
		except thread.error, e:
			myID = i
			spinlockConsumerThread[myID] = 1
			print "ConsumerThread thread creation failed"
			print e

	while (0 in spinlockProducerThread or 0 in spinlockConsumerThread):
		time.sleep(1)
		pass</pre>
</td>
</tr>
</tbody>
</table>
<p>[PROFILE]</p>
<p><span style="text-decoration:underline;"><a href="http://docs.python.org/library/profile.html">http://docs.python.org/library/profile.html</a></span></p>
<p>[Mike C. Fletcher]</p>
<p>Mike C. Fletcher (<a href="http://www.vrplumber.com/" target="_blank">http://www.vrplumber.com</a>)</p>
<p>[GPROF2DOT]</p>
<p><a href="http://code.google.com/p/jrfonseca/wiki/Gprof2Dot">http://code.google.com/p/jrfonseca/wiki/Gprof2Dot</a></p>
<p>[PROFILE]</p>
<p><a href="http://docs.python.org/library/profile.html">http://docs.python.org/library/profile.html</a></p>
<p>[DIS]</p>
<p><a href="http://docs.python.org/library/dis.html">http://docs.python.org/library/dis.html</a></p>
<p>[LOCKING HIERARCHY]</p>
<p><a href="http://www.ddj.com/architect/204801163">http://www.ddj.com/architect/204801163</a></p>
<p>[PYTHON AND C]</p>
<p><a href="http://docs.python.org/extending/extending.html">http://docs.python.org/extending/extending.html</a></p>
<p>[SCIPY]</p>
<p><a href="http://www.scipy.org/">http://www.scipy.org/</a></p>
<div id="_mcePaste" style="position:absolute;left:-10000px;top:3397px;width:1px;height:1px;overflow:hidden;">class ProducerThread:<br/>
def __init__(self, myID):<br/>
self.myID = myID<br/>
while 1:<br/>
work_todo = GetWorkFromDB()<br/>
for work_item in work_todo:<br/>
workQueue.put(work_item)<br/>
break<br/>
spinlockProducerThread[myID] = 1<br/>
sys.exit()class ConsumerThread:<br/>
def __init__(self, myID):<br/>
self.myID = myID<br/>
while 1:<br/>
try:<br/>
work_item = workQueue.get(block=False)<br/>
except Queue.Empty:<br/>
&#8220;&#8221;&#8221;<br/>
The queue is empty, but it may only be temporarily empty or it may<br/>
be empty but other worker threads are still running<br/>
&#8220;&#8221;&#8221;<br/>
if (0 not in spinlockProducerThread):<br/>
spinlockConsumerThread[myID] = 1<br/>
sys.exit()<br/>
else:<br/>
ProcessWork(work_item)</p>
<p>if __name__ == &#8216;__main__&#8217;:</p>
<p>spinlockProducerThread = [0] * number_of_producer_threads</p>
<p>spinlockConsumerThread = [0] * number_of_consumer_threads</p>
<p>workQueue = Queue.Queue()</p>
<p>for i in range(number_of_producer_threads):<br/>
try:<br/>
thread.start_new_thread(ProducerThread, (i,))<br/>
except thread.error, e:<br/>
myID = i<br/>
spinlockProducerThread[myID] = 1<br/>
print &#8220;ProducerThread thread creation failed&#8221;<br/>
print e</p>
<p>for i in range(number_of_consumer_threads):<br/>
try:<br/>
thread.start_new_thread(ThreadWorkerFreescan, (i,))<br/>
except thread.error, e:<br/>
myID = i<br/>
spinlockConsumerThread[myID] = 1<br/>
print &#8220;ConsumerThread thread creation failed&#8221;<br/>
print e</p>
<p>while (0 in spinlockProducerThread or 0 in spinlockConsumerThread):<br/>
time.sleep(1)<br/>
pass</p>
</div>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled"><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-86342-61-58419f04c377f' data-src='//widgets.wp.com/likes/#blog_id=86342&amp;post_id=61&amp;origin=kurtseifried.wordpress.com&amp;obj_id=86342-61-58419f04c377f' data-name='like-post-frame-86342-61-58419f04c377f'><h3 class='sd-title'>Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts'>
<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div></div>
<p class="clear">Tags: <a href="http://kurt.seifried.org/tag/performance/" rel="tag">performance</a>, <a href="http://kurt.seifried.org/tag/python-2/" rel="tag">python</a></p>
<p class="postmetadata alt">
<small>
This entry was posted on May 31, 2010 at 2:34 AM and is filed under <a href="http://kurt.seifried.org/category/python/" rel="category tag">Python</a>. You can follow any responses to this entry through the <a href='http://kurt.seifried.org/2010/05/31/python-performance-part-3/feed/'>RSS 2.0</a> feed.
You can <a href="#respond">leave a response</a>, or <a href="http://kurt.seifried.org/2010/05/31/python-performance-part-3/trackback/" rel="trackback">trackback</a> from your own site.
</small>
</p>
</div>
</div>
 
<div id="respond" class="comment-respond">
<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2010/05/31/python-performance-part-3/#respond" style="display:none;">Cancel reply</a></small></h3> <form action="http://kurt.seifried.org/wp-comments-post.php" method="post" id="commentform" class="comment-form">
<input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="644ee5962f"/><input type="hidden" name="_wp_http_referer" value="/2010/05/31/python-performance-part-3/"/>
<input type="hidden" name="hc_post_as" id="hc_post_as" value="guest"/>
<div class="comment-form-field comment-textarea">
<label for="comment">Enter your comment here...</label>
<div id="comment-form-comment"><textarea id="comment" name="comment" title="Enter your comment here..."></textarea></div>
</div>
<div id="comment-form-identity" class="comment_registration">
<div id="comment-form-nascar">
<p>Please log in using one of these methods to post your comment:</p>
<ul>
<li>
<a href="#comment-form-load-service:WordPress.com" id="postas-wordpress" title="WordPress.com">
<span></span>
</a>
</li>
<li>
<a href="#comment-form-load-service:Twitter" id="postas-twitter" title="Twitter">
<span></span>
</a>
</li>
<li>
<a href="#comment-form-load-service:Facebook" id="postas-facebook" title="Facebook">
<span></span>
</a>
</li>
<li>
</ul>
</div>
<div id="comment-form-guest" class="comment-form-service selected">
<div class="comment-form-padder">
<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank"> <img src="" alt="Gravatar" width="25" class="no-grav"/>
</a> </div>
<div class="comment-form-fields">
<div class="comment-form-field comment-form-email">
<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
<div class="comment-form-input"><input id="email" name="email" type="email" value=""/></div>
</div>
<div class="comment-form-field comment-form-author">
<label for="author">Name <span class="required">(required)</span></label>
<div class="comment-form-input"><input id="author" name="author" type="text" value=""/></div>
</div>
<div class="comment-form-field comment-form-url">
<label for="url">Website</label>
<div class="comment-form-input"><input id="url" name="url" type="url" value=""/></div>
</div>
</div>
</div>
</div>
<div id="comment-form-wordpress" class="comment-form-service">
<div class="comment-form-padder">
<div class="comment-form-avatar">
<img src="" alt="WordPress.com Logo" width="25" class="no-grav"/>
</div>
<div class="comment-form-fields">
<input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value=""/>
<input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value=""/>
<input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value=""/>
<p class="comment-form-posting-as pa-wordpress"><strong></strong> You are commenting using your WordPress.com account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'wordpress' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
</div>
</div>
</div>
<div id="comment-form-twitter" class="comment-form-service">
<div class="comment-form-padder">
<div class="comment-form-avatar">
<img src="" alt="Twitter picture" width="25" class="no-grav"/>
</div>
<div class="comment-form-fields">
<input type="hidden" name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value=""/>
<input type="hidden" name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value=""/>
<input type="hidden" name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value=""/>
<p class="comment-form-posting-as pa-twitter"><strong></strong> You are commenting using your Twitter account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'twitter' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
</div>
</div>
</div>
<div id="comment-form-facebook" class="comment-form-service">
<div class="comment-form-padder">
<div class="comment-form-avatar">
<img src="" alt="Facebook photo" width="25" class="no-grav"/>
</div>
<div class="comment-form-fields">
<input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value=""/>
<input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value=""/>
<input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value=""/>
<p class="comment-form-posting-as pa-facebook"><strong></strong> You are commenting using your Facebook account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'facebook' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
</div>
</div>
</div>
<div id="comment-form-googleplus" class="comment-form-service">
<div class="comment-form-padder">
<div class="comment-form-avatar">
<img src="" alt="Google+ photo" width="25" class="no-grav"/>
</div>
<div class="comment-form-fields">
<input type="hidden" name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value=""/>
<input type="hidden" name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value=""/>
<input type="hidden" name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value=""/>
<p class="comment-form-posting-as pa-googleplus"><strong></strong> You are commenting using your Google+ account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'googleplus' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
</div>
</div>
</div>
<div id="comment-form-load-service" class="comment-form-service">
<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
<p>Connecting to %s</p>
</div>
</div>
<script type="text/javascript">
var highlander_expando_javascript = function(){
	var input = document.createElement( 'input' ),
	    comment = jQuery( '#comment' );

	if ( 'placeholder' in input ) {
		comment.attr( 'placeholder', jQuery( '.comment-textarea label' ).remove().text() );
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	jQuery( '#comment-form-identity' ).hide();
	jQuery( '#comment-form-subscribe' ).hide();
	jQuery( '#commentform .form-submit' ).hide();

	comment.css( { 'height':'10px' } ).one( 'focus', function() {
		var timer = setInterval( HighlanderComments.resizeCallback, 10 )
		jQuery( this ).animate( { 'height': HighlanderComments.initialHeight } ).delay( 100 ).queue( function(n) { clearInterval( timer ); HighlanderComments.resizeCallback(); n(); } );
		jQuery( '#comment-form-identity' ).slideDown();
		jQuery( '#comment-form-subscribe' ).slideDown();
		jQuery( '#commentform .form-submit' ).slideDown();
	});
}
jQuery(document).ready( highlander_expando_javascript );
</script>
<div id="comment-form-subscribe">
<p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;"/> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p><p class="post-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto;"/> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog" style="display: inline;">Notify me of new posts via email.</label></p></div>
<p class="form-submit">
<input name="submit" type="submit" id="comment-submit" value="Post Comment"/>
<input type='hidden' name='comment_post_ID' value='61' id='comment_post_ID'/>
<input type='hidden' name='comment_parent' id='comment_parent' value='0'/>
</p>
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="856eccb007"/></p>
<input type="hidden" name="genseq" value="1480695556"/>
<p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="195"/></p> </form>
</div> 
<div style="clear: both"></div>
</div>
<hr/>
<div id="footer">
<p>
<a href="https://wordpress.com/?ref=footer_blog">Blog at WordPress.com.</a>
<br/><a href="http://kurt.seifried.org/feed/">Entries (RSS)</a> and <a href="http://kurt.seifried.org/comments/feed/">Comments (RSS)</a>. </p>
</div>
</div>
 
<div style="display:none">
</div>
<script type='text/javascript'>
/* <![CDATA[ */
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"https:\/\/kurtseifried.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/kurtseifried.wordpress.com\/wp-login.php?action=logout&_wpnonce=724fd47a24","homeURL":"http:\/\/kurt.seifried.org\/","postID":"61","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"1","userIsLoggedIn":"","isJetpack":"0","text_direction":"ltr"};
/* ]]> */
</script>
<script type='text/javascript' src='https://s2.wp.com/_static/??/wp-content/js/jquery/jquery.autoresize.js,/wp-content/mu-plugins/highlander-comments/script.js?m=1479964158j'></script>
<script type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/akismet-3.0/_inc/form.js?m=1404442431h'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var actionbardata = {"siteID":"86342","siteName":"Kurt Seifried","siteURL":"http:\/\/kurt.seifried.org","icon":"<img alt='' src='https:\/\/s1.wp.com\/i\/void.gif' class='avatar avatar-36' height='36' width='36' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/kubrick","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/kurtseifried.wordpress.com\/wp-login.php?redirect_to=http%3A%2F%2Fkurt.seifried.org%2F2010%2F05%2F31%2Fpython-performance-part-3%2F","themeURL":"","xhrURL":"http:\/\/kurt.seifried.org\/wp-admin\/admin-ajax.php","nonce":"c5d9519be6","isSingular":"1","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"321560f319\" \/>","referer":"http:\/\/kurt.seifried.org\/2010\/05\/31\/python-performance-part-3\/","canFollow":"1","statusMessage":"","customizeLink":"https:\/\/kurtseifried.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fkurtseifried.wordpress.com%2F2010%2F05%2F31%2Fpython-performance-part-3%2F","postID":"61","shortlink":"http:\/\/wp.me\/pmsC-Z","canEditPost":"","editLink":"https:\/\/wordpress.com\/post\/kurt.seifried.org\/61","i18n":{"view":"View Site","follow":"Follow","following":"Following","edit":"Edit","login":"Log In","signup":"Sign Up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Kubrick","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editFollows":"Manage Sites I Follow","editSubs":"Manage Subscriptions","viewReader":"View Site in the Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/kurtseifried.wordpress.com\/wp-login.php?redirect_to=http%3A%2F%2Fkurt.seifried.org%2F2010%2F05%2F31%2Fpython-performance-part-3%2F\">Log in now.<\/a>"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://s0.wp.com/_static/??-eJx9jEEOwjAMBD9EalBRywXxlpBY4BI7wUkK/J70QMWpt9XO7sArGReloBSYMnicyWF6d1PewR/ialKoN5IMgR6Y4Vmx4t2KD6i/MYkL1TfYRC4yt6NRTOHTMcmG0frGzdUqsM0FtSUTZ1SlRbZ2WwZXKMpiWFNbX/h8OI5D35+GcT99AYXhVt0='></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script> <iframe src='http://widgets.wp.com/likes/master.html?ver=20160429#ver=20160429' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
<div id='likes-other-gravatars'><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
<script>
			var _comscore = _comscore || [];
			_comscore.push({
				c1: "2",
				c2: "7518284"
			});
			(function() {
				var s = document.createElement("script"),
					el = document.getElementsByTagName("script")[0];
				s.async = true;
				s.src = (document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js";
				el.parentNode.insertBefore(s, el);
			})();
		</script>
<noscript>
<p class="robots-nocontent"><img src="http://b.scorecardresearch.com/p?c1=2&c2=7518284&c3=&c4=&c5=&c6=&c15=&cv=2.0&cj=1" alt="" style="display:none;" width="1" height="1"/></p>
</noscript><script src="//stats.wp.com/w.js?55" type="text/javascript" async defer></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'86342','blog_tz':'-7','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'86342','v':'wpcom','tz':'-7','user_id':'0','post':'61','subd':'kurtseifried'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1TaVhzUzFMbjdWNHpwZGhTayxPSUFCMGRVYVNrSFguN3FwSmQ5RGtNX3VQcj1yVzhiflM1THQtLGFdQ2toOXYlSTFFR3FyWV8vNWlURCVDWHdySjh8XVMzP1V+ZlNZQS9uUHRpTSZuOEhqXTVCOUFDRGpkKzhLSWVBNWRGLmRbKywrZixVTHRPWGsyMk5wZy9vU1duQkNpdXNZLGRRfGQ0SyZod2Q9JndLdDRobCxQYmU2K3MlRlRNRSt+PTFLSm1IUT1KTDdJQjM/PVlaano2S1csZD9mbGxpJmVlVVJwWExIUEElTERZdj8/RzVEUTJrfjclSi9bQ1pbcSssTw=='}]);
_stq.push([ 'clickTrackerInit', '86342', '61' ]);
	</script>
<noscript><img src="http://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt=""/></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script></body>
</html>
